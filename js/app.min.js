function googleError(){alert("Google Maps script failed to load. Please check network connection")}function googleSuccess(){ko.applyBindings(new viewModel)}var model=[{title:"Kerry Park",lat:47.629552,lng:-122.360127,venueID:"4558a938f964a520493d1fe3"},{title:"Showbox Sodo",lat:47.587926,lng:-122.333627,venueID:"472e59eaf964a520074c1fe3"},{title:"Toulouse Petit",lat:47.624761,lng:-122.357008,venueID:"4ae60430f964a52018a421e3"},{title:"GameWorks",lat:47.611909,lng:-122.334027,venueID:"40b7d280f964a5208d001fe3"},{title:"Trading Musician",lat:47.671845,lng:-122.317115,venueID:"4ae0f365f964a520fb8321e3"},{title:"Brave Horse Tavern",lat:47.621754,lng:-122.336879,venueID:"4d9a7c885e52224b217e2ee3"},{title:"Uncle Ike's",lat:47.613352,lng:-122.302226,venueID:"542b0848498e259fb7853267"},{title:"Pagliacci Pizza",lat:47.624396,lng:-122.356561,venueID:"459c14eef964a52095401fe3"},{title:"The Masonry",lat:47.625676,lng:-122.355746,venueID:"51fdb194498e5101da70bb56"},{title:"Cinerama",lat:47.614275,lng:-122.341445,venueID:"4276bf00f964a52083211fe3"}];$(".button-collapse").sideNav({});var infoWindow,viewModel=function(){var a=this;a.googleMap=new google.maps.Map(document.getElementById("map"),{zoom:13,center:{lat:47.625143,lng:-122.326594}});var b=new google.maps.LatLngBounds,c=new google.maps.LatLng(47.590211,-122.396608),d=new google.maps.LatLng(47.679511,-122.243143);b.extend(c),b.extend(d),a.googleMap.fitBounds(b),a.allMarkers=[];var e=function(a){this.title=a.title,this.lat=a.lat,this.lng=a.lng,this.venueID=a.venueID,this.marker=null};model.forEach(function(b){a.allMarkers.push(new e(b))});var f="https://api.foursquare.com/v2/venues/",g="?client_id=NVT0H2AVTCVAS3AZM5M5ITUQ4Q1D05GA2LL0BW33OEVEPAFE&client_secret=BTEL02NGF4LMABLSNMYAKKLC43N0ZH0QUDZYB4H54Q3VSEDD&v=20130815";a.allMarkers.forEach(function(b){var c={map:a.googleMap,animation:google.maps.Animation.DROP,title:b.title,position:{lat:b.lat,lng:b.lng}};b.marker=new google.maps.Marker(c),infoWindow=new google.maps.InfoWindow({content:null}),b.marker.addListener("click",function(c){return function(){a.googleMap.panTo(c.getPosition()),infoWindow.open(a.googleMap,c),$.getJSON(f+b.venueID+g,function(a){var b=a.response.venue;infoWindow.setContent(""),infoWindow.setContent("<h3>"+b.name+"</h3><h5>"+b.categories[0].name+'</h5><div><div id="icon"><img src="'+b.categories[0].icon.prefix+"bg_64"+b.categories[0].icon.suffix+'" ></div><div id="address"><h6>Address:</h6><p>'+b.location.address+"</p><p>"+b.location.city+", "+b.location.state+", "+b.location.postalCode+'</p></div></div><div id="center"><img src="'+b.photos.groups[0].items[0].prefix+"200x200"+b.photos.groups[0].items[0].suffix+'""><img src="'+b.photos.groups[0].items[1].prefix+"200x200"+b.photos.groups[0].items[1].suffix+'""><img src="'+b.photos.groups[0].items[2].prefix+"200x200"+b.photos.groups[0].items[3].suffix+'""></div><p id="attribution">Info and photos courtesy of FourSquare</p>')}).fail(function(){infoWindow.setContent("<div>Network Error.</div>")}),c.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){c.setAnimation(null)},1400)}}(b.marker))}),a.visibleMarkers=ko.observableArray(),a.allMarkers.forEach(function(b){a.visibleMarkers.push(b)}),a.query=ko.observable(""),a.search=function(){var b=a.query().toLowerCase();a.visibleMarkers.removeAll(),a.allMarkers.forEach(function(c){c.marker.setVisible(!1),-1!==c.title.toLowerCase().indexOf(b)&&a.visibleMarkers.push(c)}),a.visibleMarkers().forEach(function(a){a.marker.setVisible(!0)})},a.listClick=function(a){google.maps.event.trigger(a.marker,"click")}};